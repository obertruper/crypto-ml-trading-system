# üöÄ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Feature Selection –≤ XGBoost v3.0

## üìù –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞:**
- ROC-AUC ‚âà 0.50 (—Å–ª—É—á–∞–π–Ω–æ–µ —É–≥–∞–¥—ã–≤–∞–Ω–∏–µ)
- 40% –≤–∞–∂–Ω–æ—Å—Ç–∏ —É –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (dow_cos, hour_sin)
- 10% –≤–∞–∂–Ω–æ—Å—Ç–∏ —É —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∞—Ö

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

**optimal_crypto_config.yaml:**
```yaml
# –ë—ã–ª–æ:
primary_features_ratio: 0.7    # 70% —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö
auxiliary_features_ratio: 0.2  # 20% –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö

# –°—Ç–∞–ª–æ:
primary_features_ratio: 0.8    # 80% —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö  
auxiliary_features_ratio: 0.02 # 2% –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö (—Ä–µ–∑–∫–æ —É–º–µ–Ω—å—à–µ–Ω–æ!)
```

### 2. **–ù–æ–≤—ã–µ —Ü–µ–ª–µ–≤—ã–µ –∫–≤–æ—Ç—ã –≤ feature_mapping.py**

```python
def get_category_targets():
    return {
        'technical': 85,     # 85% (–±—ã–ª–æ 80%)
        'temporal': 2,       # 2% (–±—ã–ª–æ 5%)
        'btc_related': 10,   # 10% (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        'symbol': 3,         # 3% (–±—ã–ª–æ 5%)
        'other': 0           # 0%
    }
```

### 3. **Temporal blacklist**

–î–æ–±–∞–≤–ª–µ–Ω —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è:
```python
def get_temporal_blacklist():
    return [
        'dow_sin', 'dow_cos',    # –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏ - –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
        'is_weekend',            # –í—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏
    ]
```

### 4. **–£–º–µ–Ω—å—à–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**

**features_config.py:**
```python
# –ë—ã–ª–æ: 4 –æ–∫–Ω–∞ —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö
'rolling_windows': [5, 10, 20, 60]

# –°—Ç–∞–ª–æ: —Ç–æ–ª—å–∫–æ 2 –æ–∫–Ω–∞
'rolling_windows': [20, 60]
```

### 5. **–ñ–µ—Å—Ç–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –≤ feature_selector.py**

- ‚úÖ **Blacklist –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è** —Å—Ä–∞–∑—É –ø—Ä–∏ –æ—Ç–±–æ—Ä–µ
- ‚úÖ **–ú–∞–∫—Å–∏–º—É–º 1 temporal –ø—Ä–∏–∑–Ω–∞–∫** –¥–ª—è top_k ‚â§ 50
- ‚úÖ **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** –ª–∏—à–Ω–∏—Ö temporal –ø–æ—Å–ª–µ –æ—Ç–±–æ—Ä–∞
- ‚úÖ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç technical** –ø—Ä–∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–≤–æ—Ç

### 6. **–ù–æ–≤—ã–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**

**FeatureImportanceValidator** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è:
- ‚ö†Ô∏è **Temporal ‚â§ 3%** –≤–∞–∂–Ω–æ—Å—Ç–∏ (–∫—Ä–∏—Ç–∏—á–Ω–æ –µ—Å–ª–∏ –±–æ–ª—å—à–µ)
- ‚ö†Ô∏è **Technical ‚â• 70%** –≤–∞–∂–Ω–æ—Å—Ç–∏
- ‚ö†Ô∏è **Temporal –Ω–µ –≤–∞–∂–Ω–µ–µ Technical**
- ‚ö†Ô∏è **Blacklist –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ –≤ —Ç–æ–ø–µ**

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
python test_feature_selection_fixes.py
```

**–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã ‚úÖ**

### Feature Mapping ‚úÖ
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è: 7/7 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –¶–µ–ª–µ–≤—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã: 85/2/10/3
- Blacklist: ['dow_sin', 'dow_cos', 'is_weekend']

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ‚úÖ
- Rolling windows —É–º–µ–Ω—å—à–µ–Ω—ã: [20, 60] 
- –ù–æ–≤—ã–µ —Ü–µ–ª–µ–≤—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã

### Feature Selector ‚úÖ
- Blacklist –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ temporal
- –ñ–µ—Å—Ç–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –º–∞–∫—Å–∏–º—É–º 1 temporal –ø—Ä–∏–∑–Ω–∞–∫
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

### Validator ‚úÖ
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ temporal
- –í—ã–¥–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- Temporal –≤–∞–∂–Ω–æ—Å—Ç—å: 40%
- Technical –≤–∞–∂–Ω–æ—Å—Ç—å: 10% 
- ROC-AUC: 0.50

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- Temporal –≤–∞–∂–Ω–æ—Å—Ç—å: ‚â§ 3%
- Technical –≤–∞–∂–Ω–æ—Å—Ç—å: ‚â• 80%
- ROC-AUC: –æ–∂–∏–¥–∞–µ—Ç—Å—è 0.65+

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û–±—É—á–µ–Ω–∏–µ —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏:
```bash
cd xgboost_v3
python main.py --config optimal_crypto_config.yaml
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```bash
python test_feature_selection_fixes.py
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏:
–í–∞–ª–∏–¥–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –∏ –≤—ã–≤–æ–¥–∏—Ç:
- ‚úÖ –ï—Å–ª–∏ –≤—Å–µ –≤ –ø–æ—Ä—è–¥–∫–µ
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è—Ö
- ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–∏

## üìã –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

1. **optimal_crypto_config.yaml** - –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–≤–æ—Ç—ã
2. **config/feature_mapping.py** - –Ω–æ–≤—ã–µ —Ü–µ–ª–µ–≤—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –∏ blacklist
3. **config/features_config.py** - —É–º–µ–Ω—å—à–µ–Ω–Ω—ã–µ rolling windows
4. **utils/feature_selector.py** - –∂–µ—Å—Ç–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å temporal
5. **utils/feature_importance_validator.py** - –Ω–æ–≤—ã–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä
6. **main.py** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
7. **test_feature_selection_fixes.py** - —Ç–µ—Å—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ temporal –ª–∏–º–∏—Ç–∞:
```python
validator = FeatureImportanceValidator(max_temporal_importance=1.0)  # 1%
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö temporal –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ blacklist:
```python
# –í config/feature_mapping.py
def get_temporal_blacklist():
    return [
        'dow_sin', 'dow_cos', 'is_weekend',
        'month_sin', 'month_cos'  # –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ
    ]
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–≤–æ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:
```python
# –í config/feature_mapping.py  
def get_category_targets():
    return {
        'technical': 90,     # —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 90%
        'temporal': 1,       # —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ 1%
        'btc_related': 8,    # —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ 8%
        'symbol': 1,         # —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ 1%
    }
```

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–æ–¥–µ–ª—å –±–æ–ª—å—à–µ –Ω–µ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å—Å—è –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∞—Ö –±–ª–∞–≥–æ–¥–∞—Ä—è –∂–µ—Å—Ç–∫–æ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—é temporal –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö –ø–∞–π–ø–ª–∞–π–Ω–∞.