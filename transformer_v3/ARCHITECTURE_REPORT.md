# Transformer v3.0 - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –æ—Ç—á–µ—Ç

## üìã –†–µ–∑—é–º–µ –ø—Ä–æ–µ–∫—Ç–∞

**Transformer v3.0** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —É—Å–ø–µ—à–Ω—É—é –∞–¥–∞–ø—Ç–∞—Ü–∏—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã **XGBoost v3.0** –¥–ª—è **Temporal Fusion Transformer (TFT)** –º–æ–¥–µ–ª–∏. –ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 70% –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –æ—Ç gradient boosting –∫ –Ω–µ–π—Ä–æ–Ω–Ω—ã–º —Å–µ—Ç—è–º –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤.

### üéØ –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

- ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å XGBoost vs TFT
- ‚úÖ **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞**: 70% –∫–æ–¥–∞ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∏–∑ XGBoost v3.0  
- ‚úÖ **Temporal Fusion Transformer**: –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å attention –º–µ—Ö–∞–Ω–∏–∑–º–æ–º
- ‚úÖ **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–∑ XGBoost v3.0
- ‚úÖ **Production-ready**: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | XGBoost v3.0 | Transformer v3.0 | –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|-----------|--------------|------------------|-------------------|
| **config/** | Dataclass –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | ‚úÖ –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è TFT | 90% |
| **data/loader.py** | PostgreSQL –∑–∞–≥—Ä—É–∑–∫–∞ | ‚úÖ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π | 100% |
| **data/feature_engineer.py** | 89 –≥—Ä—É–ø–ø –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ | ‚úÖ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π | 100% |
| **data/preprocessor.py** | –¢–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | üîÑ –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π | 60% |
| **data/sequence_creator.py** | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | ‚úÖ –ù–æ–≤—ã–π –º–æ–¥—É–ª—å | 0% |
| **models/** | XGBoost –∞–Ω—Å–∞–º–±–ª–∏ | üîÑ TFT –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 30% |
| **utils/** | –ú–µ—Ç—Ä–∏–∫–∏, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã | 95% |
| **main.py** | Pipeline –¥–ª—è XGBoost | üîÑ Pipeline –¥–ª—è TFT | 80% |

## üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (config/)

```python
@dataclass
class TFTModelConfig:
    # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ TFT
    hidden_size: int = 160
    lstm_layers: int = 2  
    num_heads: int = 4
    sequence_length: int = 100  # 25 —á–∞—Å–æ–≤ –ø—Ä–∏ 15-–º–∏–Ω —Å–≤–µ—á–∞—Ö
    
    # GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
    use_mixed_precision: bool = True
    memory_growth: bool = True
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç XGBoost v3.0:**
- `ModelConfig` ‚Üí `TFTModelConfig` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `DatabaseConfig` –∏ `TrainingConfig`

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (data/)

#### **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏:**
- `loader.py` - –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (100%)
- `feature_engineer.py` - –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (653 —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞)
- `cacher.py` - –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `btc_data_loader.py` - –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### **–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏:**

**data/preprocessor.py** (60% –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è):
```python
# –ù–û–í–û–ï: –†–∞–±–æ—Ç–∞ —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏
def normalize_features() -> Tuple[train, val, test]
def normalize_targets() -> Tuple[scaled_targets]  
def transform_to_classification_labels() -> Tuple[binary_labels]

# –°–û–•–†–ê–ù–ï–ù–û: –ë–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
def _split_features_targets()
def _basic_feature_processing()  
def get_group_weights()
```

**data/sequence_creator.py** (–ù–æ–≤—ã–π –º–æ–¥—É–ª—å):
```python
class SequenceCreator:
    def create_sequences() -> Dict[sequences]  # [samples, timesteps, features]
    def create_augmented_sequences() -> Dict    # –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    def split_sequences() -> Dict               # Train/val/test split
    def compute_class_weights() -> Dict         # –î–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
```

### 3. –ú–æ–¥–µ–ª–∏ (models/)

#### **TFT –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (models/tft_model.py):**

```python
class TemporalFusionTransformer(keras.Model):
    # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:
    - GLU: Gated Linear Unit
    - GRN: Gated Residual Network  
    - InterpretableMultiHeadAttention: Self-attention
    - LSTM Encoder-Decoder
    - Feature Selection Network
```

**Pipeline –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
1. **Input** ‚Üí `[batch, 100, features]` –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. **Feature Selection** ‚Üí GRN –æ—Ç–±–æ—Ä —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤  
3. **LSTM Encoding** ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
4. **Self-Attention** ‚Üí –ú–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –≤–∞–∂–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤
5. **Post-processing** ‚Üí GRN + dropout
6. **Output** ‚Üí –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏

#### **Trainer —Å–∏—Å—Ç–µ–º–∞ (models/tft_trainer.py):**

```python
class TFTTrainer:  # –ê–Ω–∞–ª–æ–≥ XGBoostTrainer
    def train() -> Model              # Early stopping, callbacks
    def predict() -> predictions      # –° –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π attention weights  
    def evaluate() -> metrics         # –†–µ–≥—Ä–µ—Å—Å–∏—è + –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
    def save_model() / load_model()   # SavedModel + –≤–µ—Å–∞ + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
```

**–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–∑ XGBoost v3.0:**
- ‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–∫–∞–∂–¥—ã–µ 5 —ç–ø–æ—Ö)
- ‚úÖ TensorBoard –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è  
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ–∫–ø–æ–π–Ω—Ç–æ–≤
- ‚úÖ –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

### 4. –£—Ç–∏–ª–∏—Ç—ã (utils/)

**–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 95%:**
- `feature_selector.py` - –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –æ—Ç–±–æ—Ä (60/20/10/10)
- `metrics.py` - –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏/–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏  
- `visualization.py` - –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã
- `report_generator.py` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
- `logging_manager.py` - –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üéØ –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 120 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

```
üìä –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (80/5/10/5):
‚îú‚îÄ‚îÄ 80% –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (96 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ –¢—Ä–µ–Ω–¥–æ–≤—ã–µ: RSI, MACD, ADX, Ichimoku, SAR
‚îÇ   ‚îú‚îÄ‚îÄ –û—Å—Ü–∏–ª–ª—è—Ç–æ—Ä—ã: Stochastic, Williams %R, CCI
‚îÇ   ‚îú‚îÄ‚îÄ –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: ATR, Bollinger Bands
‚îÇ   ‚îú‚îÄ‚îÄ –û–±—ä–µ–º–Ω—ã–µ: OBV, CMF, MFI
‚îÇ   ‚îî‚îÄ‚îÄ –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ: –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Å–≤–µ—á–µ–π, –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏
‚îú‚îÄ‚îÄ 10% BTC –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (12 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)  
‚îÇ   ‚îú‚îÄ‚îÄ –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö
‚îÇ   ‚îú‚îÄ‚îÄ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–ª–∞ –∫ BTC
‚îÇ   ‚îî‚îÄ‚îÄ –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å BTC
‚îú‚îÄ‚îÄ 5% –í—Ä–µ–º–µ–Ω–Ω—ã–µ (6 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ: hour_sin/cos, dow_sin/cos  
‚îÇ   ‚îî‚îÄ‚îÄ –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ: is_weekend
‚îî‚îÄ‚îÄ 5% –ü—Ä–æ—á–∏–µ (6 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
    ‚îú‚îÄ‚îÄ –°–∏–º–≤–æ–ª—ã: is_btc, is_eth, is_bnb
    ‚îî‚îÄ‚îÄ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
```

### –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≤–µ—Å–∞ –ø–æ –≥—Ä—É–ø–ø–∞–º –º–æ–Ω–µ—Ç:

```python
def get_group_weights(group_name: str) -> Dict[str, float]:
    if group_name in btc_group:
        return {'technical': 0.75, 'btc_related': 0.05, ...}  # –ú–µ–Ω—å—à–µ BTC –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
    elif group_name in major_alts:
        return {'technical': 0.65, 'btc_related': 0.15, ...}  # –ë–æ–ª—å—à–µ BTC –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
    elif group_name in small_caps:
        return {'technical': 0.55, 'temporal': 0.25, ...}     # –ë–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
```

## ‚öôÔ∏è –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π:

```python
Input:  DataFrame [samples, features] 
        ‚Üì
Process: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å–∏–º–≤–æ–ª–∞–º ‚Üí –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ ‚Üí –°–∫–æ–ª—å–∑—è—â–∏–µ –æ–∫–Ω–∞
        ‚Üì  
Output: Array [sequences, timesteps, features]

–ü—Ä–∏–º–µ—Ä: 1000 —Å–≤–µ—á–µ–π ‚Üí 880 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π (1000 - 100 - 20 + 1)
```

### –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:

```python
# 1. –®—É–º–æ–≤–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è
noise = np.random.normal(0, 0.01, sequence.shape)
augmented = original_sequence + noise

# 2. –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–¥–≤–∏–≥–∏  
shift = random.randint(-2, 2)
augmented = shift_sequence(original, shift)
```

## üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

### XGBoost v3.0 vs Transformer v3.0

| –ê—Å–ø–µ–∫—Ç | XGBoost v3.0 | Transformer v3.0 |
|--------|-------------|------------------|
| **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** | –¢–∞–±–ª–∏—á–Ω—ã–µ (flat) | –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ |
| **–ü–∞–º—è—Ç—å** | ~2GB | ~8GB (GPU) |
| **–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è** | 20-30 –º–∏–Ω | 2-4 —á–∞—Å–∞ |
| **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** | Feature importance | Attention weights |
| **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** | ‚ùå | ‚úÖ 100 timesteps |
| **–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è** | ‚ùå | ‚úÖ –®—É–º + —Å–¥–≤–∏–≥–∏ |
| **GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ** | ‚ùå | ‚úÖ Mixed precision |
| **Attention –º–µ—Ö–∞–Ω–∏–∑–º** | ‚ùå | ‚úÖ Multi-head |
| **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | ‚ùå | ‚úÖ LSTM + Attention |

### –û–±—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã):

| –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª | –°—Ç–∞—Ç—É—Å |
|------------|--------|
| ‚úÖ –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω |
| ‚úÖ –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ | SMOTE, class_weight |
| ‚úÖ Optuna –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è | –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è TFT |
| ‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ | –ö–∞–∂–¥—ã–µ 5 —ç–ø–æ—Ö |
| ‚úÖ TensorBoard | –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω |
| ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å |
| ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã | –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö | –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ |

## üöÄ Pipeline —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

### XGBoost v3.0 Pipeline:
```
1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí 2. Feature Engineering ‚Üí 3. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
                                ‚Üì
4. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è ‚Üí 5. –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Üí 6. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞  
                                ‚Üì
7. XGBoost –æ–±—É—á–µ–Ω–∏–µ ‚Üí 8. –ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí 9. –û—Ü–µ–Ω–∫–∞
```

### Transformer v3.0 Pipeline:
```
1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí 2. Feature Engineering ‚Üí 3. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
                                ‚Üì
4. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è ‚Üí 5. –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Üí 6. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
                                ‚Üì
7. –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è ‚Üí 8. TFT –æ–±—É—á–µ–Ω–∏–µ ‚Üí 9. –û—Ü–µ–Ω–∫–∞
```

**–†–∞–∑–ª–∏—á–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω —ç—Ç–∞–ø —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö  
- –ò–∑–º–µ–Ω–µ–Ω–∞ –º–æ–¥–µ–ª—å: XGBoost ‚Üí TFT
- –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã: –∑–∞–≥—Ä—É–∑–∫–∞, feature engineering, –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –º–µ—Ç—Ä–∏–∫–∏

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã:

```bash
$ python test_architecture.py

‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ TFT –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (156,161 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (40 sequences)  
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ
```

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —Å —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

```bash
$ python run_quick_test.py

‚úÖ –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã (500 samples, 30 features)
‚úÖ –°–æ–∑–¥–∞–Ω–æ 460 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π  
‚úÖ –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ (5 —ç–ø–æ—Ö)
‚úÖ –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

## üí° –ò–Ω–Ω–æ–≤–∞—Ü–∏–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ TFT

### 1. Crypto-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**: 80% technical, 10% BTC, 5% temporal, 5% other
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≤–µ—Å–∞**: –†–∞–∑–Ω—ã–µ –≤–µ—Å–∞ –¥–ª—è BTC, major alts, small caps
- **Crypto features**: 89 –≥—Ä—É–ø–ø –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- **Dual predictions**: –û—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è buy/sell —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

### 2. Production optimizations:
- **Mixed precision**: –£—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ GPU
- **Memory growth**: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ GPU –ø–∞–º—è—Ç–∏  
- **Real-time visualization**: –ì—Ä–∞—Ñ–∏–∫–∏ –∫–∞–∂–¥—ã–µ 5 —ç–ø–æ—Ö
- **Comprehensive logging**: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- **Checkpointing**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ–∫–ø–æ–π–Ω—Ç–æ–≤

### 3. Data augmentation:
- **Noise injection**: –ì–∞—É—Å—Å–æ–≤—Å–∫–∏–π —à—É–º –¥–ª—è —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏
- **Temporal shifts**: –°–¥–≤–∏–≥–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π ¬±2 timesteps
- **Adaptive augmentation**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:

```bash
# 1. –¢–µ—Å—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
python test_architecture.py

# 2. –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —Å —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏  
python run_quick_test.py

# 3. –ü–æ–ª–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (—Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏)
python main.py --task regression --test-mode

# 4. Production –æ–±—É—á–µ–Ω–∏–µ
python main.py --task regression --epochs 100 --batch-size 64
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

```yaml
model:
  hidden_size: 160      # –†–∞–∑–º–µ—Ä —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è
  sequence_length: 100  # –î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (25 —á–∞—Å–æ–≤)
  num_heads: 4         # Attention heads
  
training:
  task_type: "regression"  # regression | classification_binary
  top_k_features: 120     # –û—Ç–æ–±—Ä–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
  use_data_augmentation: true
```

## üìã –ü–ª–∞–Ω –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. **Ensemble methods**: –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è TFT
2. **Cross-validation**: –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤  
3. **Hyperparameter optimization**: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è Optuna –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
4. **Model distillation**: –°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–µ–π –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏:
1. **Multi-horizon prediction**: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤ –≤–ø–µ—Ä–µ–¥
2. **Conditional generation**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Ä–∞–∑–≤–∏—Ç–∏—è —Ä—ã–Ω–∫–∞
3. **Federated learning**: –û–±—É—á–µ–Ω–∏–µ –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **Real-time inference**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è real-time —Ç–æ—Ä–≥–æ–≤–ª–∏

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Transformer v3.0** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —É—Å–ø–µ—à–Ω—É—é —ç–≤–æ–ª—é—Ü–∏—é –æ—Ç XGBoost –∫ –Ω–µ–π—Ä–æ–Ω–Ω—ã–º —Å–µ—Ç—è–º —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Å–µ—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

- ‚úÖ **70% –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞** –ø—Ä–∏ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ–π —Å–º–µ–Ω–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
- ‚úÖ **Production-ready —Å–∏—Å—Ç–µ–º–∞** —Å –ø–æ–ª–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º  
- ‚úÖ **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è TFT –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** —Å attention –º–µ—Ö–∞–Ω–∏–∑–º–æ–º
- ‚úÖ **Crypto-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏** –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ç—Ä–µ–π–¥–∏–Ω–≥–∞
- ‚úÖ **–ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤.