#!/usr/bin/env python3
"""
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∏ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –¥–∞—Ç–∞—Å–µ—Ç–∞
"""

import numpy as np
import matplotlib.pyplot as plt

def demonstrate_calculation():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤ –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–∞"""
    
    print("="*80)
    print("–°–†–ê–í–ù–ï–ù–ò–ï –ü–û–î–•–û–î–û–í –ö –†–ê–°–ß–ï–¢–£ –ü–†–ò–ë–´–õ–ò")
    print("="*80)
    
    # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∑–∏—Ü–∏–∏
    entry_price = 50000  # BTC
    position_size = 1.0  # 1 BTC
    
    print(f"\nüìä –ò–°–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï:")
    print(f"–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: BTCUSDT")
    print(f"–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: BUY")
    print(f"–¶–µ–Ω–∞ –≤—Ö–æ–¥–∞: ${entry_price:,}")
    print(f"–†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏: {position_size} BTC")
    
    # –°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥
    print("\n" + "-"*60)
    print("üî¥ –°–¢–ê–†–´–ô –ü–û–î–•–û–î (prepare_dataset.py):")
    print("-"*60)
    
    sl_old = entry_price * 0.989  # -1.1%
    tp_old = entry_price * 1.058  # +5.8%
    
    print(f"Stop Loss: ${sl_old:,.2f} (-1.1%)")
    print(f"Take Profit: ${tp_old:,.2f} (+5.8%)")
    print(f"\n–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:")
    print(f"- –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ SL: —É–±—ã—Ç–æ–∫ ${(entry_price - sl_old):,.2f} (-1.1%)")
    print(f"- –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ TP: –ø—Ä–∏–±—ã–ª—å ${(tp_old - entry_price):,.2f} (+5.8%)")
    print(f"- –ë–∏–Ω–∞—Ä–Ω–∞—è –º–µ—Ç–∫–∞: 0 (loss) –∏–ª–∏ 1 (profit)")
    
    # –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥
    print("\n" + "-"*60)
    print("üü¢ –ù–û–í–´–ô –ü–û–î–•–û–î (—Å —á–∞—Å—Ç–∏—á–Ω—ã–º–∏ –∑–∞–∫—Ä—ã—Ç–∏—è–º–∏):")
    print("-"*60)
    
    print(f"–ù–∞—á–∞–ª—å–Ω—ã–π Stop Loss: ${sl_old:,.2f} (-1.1%)")
    print(f"–ù–∞—á–∞–ª—å–Ω—ã–π Take Profit: ${tp_old:,.2f} (+5.8%)")
    
    print("\nüìà –°—Ü–µ–Ω–∞—Ä–∏–π –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã:")
    
    # –°–∏–º—É–ª—è—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã
    price_levels = [
        (50600, 1.2),   # +1.2%
        (51200, 2.4),   # +2.4%
        (51750, 3.5),   # +3.5%
        (52300, 4.6),   # +4.6%
    ]
    
    position_remaining = 1.0
    realized_profit = 0
    current_sl = sl_old
    
    print("\n1Ô∏è‚É£ –¶–µ–Ω–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç $50,600 (+1.2%):")
    print("   - –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ: 20% –ø–æ–∑–∏—Ü–∏–∏")
    close_amount = 0.2
    profit_1 = close_amount * (50600 - entry_price)
    realized_profit += profit_1
    position_remaining -= close_amount
    print(f"   - –ó–∞–∫—Ä—ã—Ç–æ: {close_amount} BTC")
    print(f"   - –ü—Ä–∏–±—ã–ª—å: ${profit_1:,.2f}")
    print(f"   - SL –æ–±–Ω–æ–≤–ª–µ–Ω –≤ –±–µ–∑—É–±—ã—Ç–æ–∫: ${entry_price * 1.001:,.2f}")
    print(f"   - –û—Å—Ç–∞–ª–æ—Å—å –≤ –ø–æ–∑–∏—Ü–∏–∏: {position_remaining} BTC")
    
    print("\n2Ô∏è‚É£ –¶–µ–Ω–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç $51,200 (+2.4%):")
    print("   - –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ: 30% –ø–æ–∑–∏—Ü–∏–∏")
    print("   - –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞—â–∏—Ç–∞ –ø—Ä–∏–±—ã–ª–∏: —Ñ–∏–∫—Å–∏—Ä—É–µ–º +1.2%")
    close_amount = 0.3
    profit_2 = close_amount * (51200 - entry_price)
    realized_profit += profit_2
    position_remaining -= close_amount
    current_sl = entry_price * 1.012  # –§–∏–∫—Å–∏—Ä—É–µ–º +1.2%
    print(f"   - –ó–∞–∫—Ä—ã—Ç–æ: {close_amount} BTC")
    print(f"   - –ü—Ä–∏–±—ã–ª—å: ${profit_2:,.2f}")
    print(f"   - SL –æ–±–Ω–æ–≤–ª–µ–Ω: ${current_sl:,.2f} (–∑–∞—â–∏—Ç–∞ +1.2%)")
    print(f"   - –û—Å—Ç–∞–ª–æ—Å—å –≤ –ø–æ–∑–∏—Ü–∏–∏: {position_remaining} BTC")
    
    print("\n3Ô∏è‚É£ –¶–µ–Ω–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç $51,750 (+3.5%):")
    print("   - –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ: 30% –ø–æ–∑–∏—Ü–∏–∏")
    print("   - –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞—â–∏—Ç–∞ –ø—Ä–∏–±—ã–ª–∏: —Ñ–∏–∫—Å–∏—Ä—É–µ–º +2.4%")
    close_amount = 0.3
    profit_3 = close_amount * (51750 - entry_price)
    realized_profit += profit_3
    position_remaining -= close_amount
    current_sl = entry_price * 1.024  # –§–∏–∫—Å–∏—Ä—É–µ–º +2.4%
    print(f"   - –ó–∞–∫—Ä—ã—Ç–æ: {close_amount} BTC")
    print(f"   - –ü—Ä–∏–±—ã–ª—å: ${profit_3:,.2f}")
    print(f"   - SL –æ–±–Ω–æ–≤–ª–µ–Ω: ${current_sl:,.2f} (–∑–∞—â–∏—Ç–∞ +2.4%)")
    print(f"   - –û—Å—Ç–∞–ª–æ—Å—å –≤ –ø–æ–∑–∏—Ü–∏–∏: {position_remaining} BTC")
    
    print("\n4Ô∏è‚É£ –¶–µ–Ω–∞ –ø–∞–¥–∞–µ—Ç –¥–æ $51,200 (–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∑–∞—â–∏—Ç–Ω—ã–π SL):")
    print("   - –ó–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ—Å—Ç–∞–≤—à–∞—è—Å—è –ø–æ–∑–∏—Ü–∏—è –ø–æ –∑–∞—â–∏—Ç–Ω–æ–º—É SL")
    profit_4 = position_remaining * (current_sl - entry_price)
    realized_profit += profit_4
    print(f"   - –ó–∞–∫—Ä—ã—Ç–æ: {position_remaining} BTC –ø–æ —Ü–µ–Ω–µ ${current_sl:,.2f}")
    print(f"   - –ü—Ä–∏–±—ã–ª—å: ${profit_4:,.2f}")
    
    print("\n" + "="*60)
    print("üí∞ –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:")
    print("="*60)
    
    total_profit_percent = (realized_profit / entry_price) * 100
    
    print(f"\n–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å:")
    print(f"- –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ 1: ${profit_1:,.2f}")
    print(f"- –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ 2: ${profit_2:,.2f}")
    print(f"- –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ 3: ${profit_3:,.2f}")
    print(f"- –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ: ${profit_4:,.2f}")
    print(f"\n–û–ë–©–ê–Ø –ü–†–ò–ë–´–õ–¨: ${realized_profit:,.2f} ({total_profit_percent:.2f}%)")
    
    print("\n" + "="*60)
    print("üìä –°–†–ê–í–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:")
    print("="*60)
    
    print("\nüî¥ –°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥:")
    print("- –ë–∏–Ω–∞—Ä–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 0 –∏–ª–∏ 1")
    print("- –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–∏–±—ã–ª–∏")
    print("- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ª–∏–±–æ -1.1%, –ª–∏–±–æ +5.8%")
    
    print("\nüü¢ –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥:")
    print(f"- –¢–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: +{total_profit_percent:.2f}%")
    print("- –£—á–∏—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω—ã–µ –∑–∞–∫—Ä—ã—Ç–∏—è")
    print("- –£—á–∏—Ç—ã–≤–∞–µ—Ç –∑–∞—â–∏—Ç—É –ø—Ä–∏–±—ã–ª–∏")
    print("- –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞")
    
    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
    print("\nüìà –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏...")
    
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 6))
    
    # –ì—Ä–∞—Ñ–∏–∫ 1: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (—Å—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥)
    ax1.bar(['–£–±—ã—Ç–æ–∫\n(-1.1%)', '–ü—Ä–∏–±—ã–ª—å\n(+5.8%)'], [79.75, 10.73], 
            color=['red', 'green'], alpha=0.7)
    ax1.set_title('–°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥: –ë–∏–Ω–∞—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ', fontsize=14)
    ax1.set_ylabel('–ü—Ä–æ—Ü–µ–Ω—Ç —Å–ª—É—á–∞–µ–≤ (%)')
    ax1.set_ylim(0, 100)
    
    # –ì—Ä–∞—Ñ–∏–∫ 2: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥)
    # –°–∏–º—É–ª–∏—Ä—É–µ–º –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
    np.random.seed(42)
    results = []
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–∏–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
    # 60% - –Ω–µ–±–æ–ª—å—à–∏–µ —É–±—ã—Ç–∫–∏ (—á–∞—Å—Ç–∏—á–Ω—ã–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–º—è–≥—á–∞—é—Ç)
    results.extend(np.random.normal(-0.5, 0.5, 600))
    # 25% - –Ω–µ–±–æ–ª—å—à–∞—è –ø—Ä–∏–±—ã–ª—å (—á–∞—Å—Ç–∏—á–Ω—ã–µ –∑–∞–∫—Ä—ã—Ç–∏—è)
    results.extend(np.random.normal(1.5, 0.8, 250))
    # 10% - —Å—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å
    results.extend(np.random.normal(2.5, 0.5, 100))
    # 5% - –±–æ–ª—å—à–∞—è –ø—Ä–∏–±—ã–ª—å
    results.extend(np.random.normal(4.0, 1.0, 50))
    
    ax2.hist(results, bins=30, color='blue', alpha=0.7, edgecolor='black')
    ax2.axvline(x=0, color='red', linestyle='--', label='–ë–µ–∑—É–±—ã—Ç–æ–∫')
    ax2.axvline(x=total_profit_percent, color='green', linestyle='-', 
                linewidth=2, label=f'–ü—Ä–∏–º–µ—Ä: +{total_profit_percent:.1f}%')
    ax2.set_title('–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥: –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ', fontsize=14)
    ax2.set_xlabel('–†–µ–∑—É–ª—å—Ç–∞—Ç (%)')
    ax2.set_ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª—É—á–∞–µ–≤')
    ax2.legend()
    
    plt.tight_layout()
    plt.savefig('dataset_comparison.png', dpi=150, bbox_inches='tight')
    print("‚úÖ –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: dataset_comparison.png")
    
    # –í–ª–∏—è–Ω–∏–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
    print("\n" + "="*60)
    print("ü§ñ –í–õ–ò–Ø–ù–ò–ï –ù–ê –û–ë–£–ß–ï–ù–ò–ï –ú–û–î–ï–õ–ò:")
    print("="*60)
    
    print("\nüî¥ –ü—Ä–æ–±–ª–µ–º—ã —Å—Ç–∞—Ä–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:")
    print("1. –°–∏–ª—å–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ (10% vs 90%)")
    print("2. –ú–æ–¥–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã")
    print("3. –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –ª–æ–≥–∏–∫–∞")
    print("4. –ó–∞–≤—ã—à–µ–Ω–Ω—ã–µ –æ–∂–∏–¥–∞–Ω–∏—è –ø—Ä–∏–±—ã–ª–∏ (+5.8% —Ä–µ–¥–∫–æ –¥–æ—Å—Ç–∏–∂–∏–º—ã)")
    
    print("\nüü¢ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:")
    print("1. –ë–æ–ª–µ–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ")
    print("2. –ú–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö")
    print("3. –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —á–∞—Å—Ç–∏—á–Ω–∞—è —Ñ–∏–∫—Å–∞—Ü–∏—è –ø—Ä–∏–±—ã–ª–∏")
    print("4. –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ü–µ–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è")
    
    print("\nüí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –º–æ–¥–µ–ª–∏:")
    print("1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–≥—Ä–µ—Å—Å–∏—é –≤–º–µ—Å—Ç–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏")
    print("2. –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –æ–∂–∏–¥–∞–µ–º—É—é –ø—Ä–∏–±—ã–ª—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö")
    print("3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è")
    print("4. –£—á–∏—Ç—ã–≤–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π –ø—Ä–∏–±—ã–ª–∏")


if __name__ == "__main__":
    demonstrate_calculation()