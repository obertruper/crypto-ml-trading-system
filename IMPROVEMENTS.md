# üöÄ –£–ª—É—á—à–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ XGBoost –¥–ª—è –∫—Ä–∏–ø—Ç–æ—Ç—Ä–µ–π–¥–∏–Ω–≥–∞ v2.1

## üÜï –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–≤–µ—Ä—Å–∏—è 2.1)

### 1. **Optuna –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** üîß
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º
- 30 –∏—Å–ø—ã—Ç–∞–Ω–∏–π –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –ª—É—á—à–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç—Å—è: max_depth, learning_rate, subsample, gamma, regularization

### 2. **–°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** üìà
–î–ª—è –æ–∫–æ–Ω 10, 30, 60 –ø–µ—Ä–∏–æ–¥–æ–≤:
- RSI mean/std
- Volume mean/spike ratio
- Price momentum –∏ acceleration
- ATR expansion ratio

### 3. **–£–ª—É—á—à–µ–Ω–Ω—ã–µ –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏** üîÑ
- RSI bullish/bearish divergence —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ —ç–∫—Å—Ç—Ä–µ–º—É–º–∞–º–∏
- MACD-price divergence
- Volume-price divergence

### 4. **–ü–∞—Ç—Ç–µ—Ä–Ω—ã —Å–≤–µ—á–µ–π** üïØÔ∏è
- Hammer/Hanging Man
- Doji
- Bullish/Bearish Engulfing
- Pin Bar (bullish/bearish)

### 5. **Volume Profile** üìâ
- VWAP distance
- Volume concentration
- Relative volume by price level
- Accumulation/Distribution oscillator

### 6. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã XGBoost** ‚öôÔ∏è
- `max_depth`: 8 ‚Üí 10
- `subsample`: 0.8 ‚Üí 0.7
- `min_split_loss`: 0.01 (–Ω–æ–≤—ã–π)
- `reg_alpha`: 0.1 ‚Üí 0.05
- `reg_lambda`: 1.0 ‚Üí 0.5

## üìä –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–≤–µ—Ä—Å–∏—è 2.0)

### 1. **–í–∑–≤–µ—à–µ–Ω–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**
–î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `create_weighted_features()` –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç:

- **–ú—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è** (a*b):
  - `rsi_macd_interaction` = RSI √ó MACD histogram
  - `volume_volatility_interaction` = –æ–±—ä–µ–º √ó –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
  - `adx_trend_strength` = ADX √ó strong_trend

- **–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è** (a/b):
  - `rsi_to_adx` = RSI / ADX
  - `volume_to_volatility` = –æ–±—ä–µ–º / –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
  - `price_momentum_ratio` = –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã 4—á / –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã 16—á

- **–ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã**:
  - `momentum_composite` = RSI + MACD + ROC
  - `volatility_composite` = ATR + –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

- **–ü–∞—Ç—Ç–µ—Ä–Ω-—Å–∫–æ—Ä—ã —Å –≤–µ—Å–∞–º–∏**:
  - `oversold_reversal_score` - –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç–∏
  - `breakout_score` - –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–±–æ–µ–≤
  - `range_trading_score` - –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ

### 2. **–ò–∑–º–µ–Ω–µ–Ω –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**
- –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: 0.3% ‚Üí **1.0%** (–±–æ–ª–µ–µ —á–µ—Ç–∫–∏–µ —Å–∏–≥–Ω–∞–ª—ã)
- –ú—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (4 –∫–ª–∞—Å—Å–∞):
  - –ö–ª–∞—Å—Å 0: –ù–µ –≤—Ö–æ–¥–∏—Ç—å (< 0.5%)
  - –ö–ª–∞—Å—Å 1: –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ (0.5% - 1.5%)
  - –ö–ª–∞—Å—Å 2: –•–æ—Ä–æ—à–∞—è —Ç–æ—á–∫–∞ (1.5% - 3%)
  - –ö–ª–∞—Å—Å 3: –û—Ç–ª–∏—á–Ω–∞—è —Ç–æ—á–∫–∞ (> 3%)

### 3. **–ê–Ω–∞–ª–∏–∑ –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤**
–ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `analyze_winning_patterns()`:
- –ù–∞—Ö–æ–¥–∏—Ç —Å–∏–≥–Ω–∞–ª—ã —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é > 70%
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —É—Å–ø–µ—à–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –í—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–ª—é—á–µ–≤—ã–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º
- –ù–∞—Ö–æ–¥–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏

### 4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤**
–ú–µ—Ç–æ–¥ `filter_trading_signals()` –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã:
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å 60%
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ –Ω–∏–∑–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ —Å–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞

### 5. **–í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤**
- –î–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: `scale_pos_weight`
- –î–ª—è –º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–æ–π: —Ä–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤ —á–µ—Ä–µ–∑ `compute_class_weight`

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–¢–æ—á–Ω–æ—Å—Ç—å**: –ü–æ–≤—ã—à–µ–Ω–∏–µ —Å ~48% –¥–æ 65-75%
2. **Precision**: –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å ~46% –¥–æ 65%+
3. **–ú–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤**: –ó–∞ —Å—á–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ Optuna
4. **–õ—É—á—à–µ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤**: –ê–Ω–∞–ª–∏–∑ –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
5. **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã**: –ë–ª–∞–≥–æ–¥–∞—Ä—è Optuna

## üöÄ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

### –° Optuna –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
python run_optuna_training.py
```

### –û–±—ã—á–Ω—ã–π —Å–ø–æ—Å–æ–± (—Å –º–µ–Ω—é):
```bash
python run_improved_training.py
```

### –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫:
```bash
# –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
python train_xgboost_enhanced_v2.py --task classification_binary --ensemble_size 3

# –ú—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
python train_xgboost_enhanced_v2.py --task classification_multiclass --ensemble_size 3

# –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–±—ã—Å—Ç—Ä–æ)
python train_xgboost_enhanced_v2.py --task classification_binary --test_mode
```

## üìä –ù–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏

### –í–µ—Ä—Å–∏—è 2.0:
–í—Å–µ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ 12 –≤–∑–≤–µ—à–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
- 3 –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- 3 —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è
- 2 –∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
- 3 –ø–∞—Ç—Ç–µ—Ä–Ω-—Å–∫–æ—Ä–∞
- 1 –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è

### –í–µ—Ä—Å–∏—è 2.1:
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ 50+ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
- 24 —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- 4 –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏ (—É–ª—É—á—à–µ–Ω–Ω—ã–µ)
- 6 –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Å–≤–µ—á–µ–π
- 5 volume profile –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

**–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: ~160+**

## üîç –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å –≤—ã—Å–æ–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é
2. –í—ã–≤–æ–¥–∏—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —É—Å–ø–µ—à–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
4. –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
5. –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ Optuna

## üìù –õ–æ–≥–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- `logs/xgboost_training_*/` - –≤—Å–µ –ª–æ–≥–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∏
- `trained_model/*_xgboost_v2_*.pkl` - –æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
- `logs/*/final_report.txt` - –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
- `logs/*/feature_importance.json` - –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Optuna –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é** –¥–ª—è –ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
2. **–ù–∞—á–Ω–∏—Ç–µ —Å –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏** - –æ–Ω–∞ –æ–±—ã—á–Ω–æ –¥–∞–µ—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
3. **–†–∞–∑–º–µ—Ä –∞–Ω—Å–∞–º–±–ª—è 3** - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∫–∞—á–µ—Å—Ç–≤–æ–º –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏** - —Ç–∞–º –º–Ω–æ–≥–æ –ø–æ–ª–µ–∑–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤** –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∏—Å–∫–æ–≤